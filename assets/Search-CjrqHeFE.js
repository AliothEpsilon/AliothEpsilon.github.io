import{d as R,r as y,o as T,q as V,c as d,e as h,a,s as q,i as v,v as D,x as C,m as k,g as S,y as F,u as M,j as b,t as g,F as w,b as L,_ as m,l as $,w as A,k as x}from"./index-SHzWHVxE.js";import{p as B,f as K}from"./article-CRQ1lArP.js";const O={class:"search-input-container"},P={class:"search-input-wrapper"},H=R({__name:"SearchInput",emits:["search"],setup(l,{expose:u,emit:e}){const n=e,r=y(""),o=y(),p=()=>{r.value.trim()&&n("search",r.value)},c=()=>{var s;r.value="",(s=o.value)==null||s.focus()},i=s=>{var t;(s.ctrlKey||s.metaKey)&&s.key==="k"&&(s.preventDefault(),(t=o.value)==null||t.focus())};return T(()=>{document.addEventListener("keydown",i)}),V(()=>{document.removeEventListener("keydown",i)}),u({focus:()=>{var s;return(s=o.value)==null?void 0:s.focus()}}),(s,t)=>(h(),d("div",O,[a("div",P,[q(a("input",{ref_key:"inputRef",ref:o,"onUpdate:modelValue":t[0]||(t[0]=f=>r.value=f),type:"text",class:"search-input",placeholder:"搜索文章...",onKeyup:[C(p,["enter"]),C(c,["esc"])]},null,544),[[D,r.value]]),r.value?(h(),d("button",{key:0,class:"clear-button",onClick:c,"aria-label":"清除搜索"},[...t[1]||(t[1]=[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])):v("",!0),a("button",{class:"search-button",onClick:p,"aria-label":"搜索"},[...t[2]||(t[2]=[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("circle",{cx:"11",cy:"11",r:"8"}),a("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1)])])]),t[3]||(t[3]=a("div",{class:"search-hint"},[k(" 按 "),a("kbd",null,"Ctrl"),k(" + "),a("kbd",null,"K"),k(" 快速搜索 ")],-1))]))}}),N=S(H,[["__scopeId","data-v-51358d19"]]);function j(l,u){if(!u.trim())return[];const e=u.toLowerCase().split(/\s+/).filter(r=>r.length>0),n=[];for(const r of l){const o=U(r,e);if(o>0){const p=W(r,e);n.push({...r,score:o,matchedFields:p})}}return n.sort((r,o)=>o.score-r.score)}function U(l,u){var n,r;let e=0;for(const o of u){const p=l.title.toLowerCase(),c=l.excerpt.toLowerCase(),i=((n=l.tags)==null?void 0:n.map(t=>t.toLowerCase()))||[],s=((r=l.category)==null?void 0:r.toLowerCase())||"";p.includes(o)&&(e+=10,p.startsWith(o)&&(e+=5)),c.includes(o)&&(e+=3);for(const t of i)t.includes(o)&&(e+=7,t===o&&(e+=3));s.includes(o)&&(e+=7,s===o&&(e+=3))}return e}function W(l,u){var n,r;const e=[];for(const o of u){const p=l.title.toLowerCase(),c=l.excerpt.toLowerCase(),i=((n=l.tags)==null?void 0:n.map(t=>t.toLowerCase()))||[],s=((r=l.category)==null?void 0:r.toLowerCase())||"";p.includes(o)&&(e.includes("title")||e.push("title")),c.includes(o)&&(e.includes("content")||e.push("content"));for(const t of i)if(t.includes(o)){e.includes("tags")||e.push("tags");break}s.includes(o)&&(e.includes("category")||e.push("category"))}return e}function E(l,u){if(!u.trim())return l;const e=u.toLowerCase().split(/\s+/).filter(r=>r.length>0);let n=l;for(const r of e){const o=new RegExp(`(${z(r)})`,"gi");n=n.replace(o,"<mark>$1</mark>")}return n}function z(l){return l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const G={class:"search-page"},J={class:"search-header"},Q={key:0,class:"search-results"},X={class:"search-info"},Y={class:"search-count"},Z={class:"search-query"},ee={key:0,class:"results-list"},te=["innerHTML"],se={class:"result-meta"},oe={class:"result-date"},re={key:0,class:"result-category"},ae={key:1,class:"matched-fields"},ne=["innerHTML"],ce={key:0,class:"result-tags"},le={key:1,class:"no-results"},ie={key:1,class:"search-placeholder"},ue=R({__name:"Search",setup(l){const u=M(),e=y(""),n=y([]),r=c=>{e.value=c,o()},o=async()=>{if(!e.value.trim()){n.value=[];return}const c=Object.assign({"../../articles/code-highlight-test.md":()=>m(()=>import("./code-highlight-test-BdVhotBU.js"),[]).then(s=>s.default),"../../articles/markdown-guide.md":()=>m(()=>import("./markdown-guide-CKdAcJBy.js"),[]).then(s=>s.default),"../../articles/vite-vue3-typescript.md":()=>m(()=>import("./vite-vue3-typescript-jK-d3Io_.js"),[]).then(s=>s.default),"../../articles/welcome.md":()=>m(()=>import("./welcome-Do8r4YiI.js"),[]).then(s=>s.default)}),i=[];for(const s in c){const t=c[s],f=await t(),I=s.replace("../../articles/","").replace(".md",""),_=B(f,I);i.push({slug:_.slug,title:_.title,date:_.date,tags:_.tags,category:_.category,excerpt:_.excerpt||""})}n.value=j(i,e.value)},p=c=>({title:"标题",content:"内容",tags:"标签",category:"分类"})[c]||c;return F(()=>u.query.q,c=>{c&&typeof c=="string"&&(e.value=c,o())},{immediate:!0}),T(()=>{u.query.q&&typeof u.query.q=="string"&&(e.value=u.query.q,o())}),(c,i)=>{const s=$("RouterLink");return h(),d("div",G,[a("div",J,[i[0]||(i[0]=a("h1",{class:"search-title"},"搜索",-1)),b(N,{ref:"searchInputRef",onSearch:r},null,512)]),e.value?(h(),d("div",Q,[a("div",X,[a("span",Y,g(n.value.length)+" 篇文章",1),a("span",Z,'包含 "'+g(e.value)+'"',1)]),n.value.length>0?(h(),d("div",ee,[(h(!0),d(w,null,L(n.value,t=>(h(),d("div",{key:t.slug,class:"result-item"},[b(s,{to:`/article/${t.slug}`,class:"result-link"},{default:A(()=>[a("h2",{class:"result-title",innerHTML:x(E)(t.title,e.value)},null,8,te),a("div",se,[a("span",oe,g(x(K)(t.date)),1),t.category?(h(),d("span",re,g(t.category),1)):v("",!0),t.matchedFields?(h(),d("div",ae,[(h(!0),d(w,null,L(t.matchedFields,f=>(h(),d("span",{key:f,class:"matched-field"},g(p(f)),1))),128))])):v("",!0)]),a("p",{class:"result-excerpt",innerHTML:x(E)(t.excerpt,e.value)},null,8,ne),t.tags&&t.tags.length>0?(h(),d("div",ce,[(h(!0),d(w,null,L(t.tags,f=>(h(),d("span",{key:f,class:"tag"},g(f),1))),128))])):v("",!0)]),_:2},1032,["to"])]))),128))])):(h(),d("div",le,[...i[1]||(i[1]=[a("p",null,"没有找到匹配的文章",-1),a("p",{class:"no-results-hint"},"尝试使用不同的关键词搜索",-1)])]))])):(h(),d("div",ie,[...i[2]||(i[2]=[a("p",null,"输入关键词开始搜索文章",-1)])]))])}}}),pe=S(ue,[["__scopeId","data-v-cecf10cd"]]);export{pe as default};
