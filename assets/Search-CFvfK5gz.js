import{d as E,r as v,k as R,s as F,a as d,o as h,b as a,w as I,j as m,z as M,A as C,f as y,_ as S,q as V,u as $,g as b,t as g,F as k,e as w,l as x,y as D,h as A,i as L}from"./index-l0Mutg87.js";import{p as B,f as K}from"./article-DfwNoQky.js";const H={class:"search-input-container"},N={class:"search-input-wrapper"},O=E({__name:"SearchInput",emits:["search"],setup(l,{expose:u,emit:e}){const n=e,r=v(""),s=v(),p=()=>{r.value.trim()&&n("search",r.value)},c=()=>{var o;r.value="",(o=s.value)==null||o.focus()},i=o=>{var t;(o.ctrlKey||o.metaKey)&&o.key==="k"&&(o.preventDefault(),(t=s.value)==null||t.focus())};return R(()=>{document.addEventListener("keydown",i)}),F(()=>{document.removeEventListener("keydown",i)}),u({focus:()=>{var o;return(o=s.value)==null?void 0:o.focus()}}),(o,t)=>(h(),d("div",H,[a("div",N,[I(a("input",{ref_key:"inputRef",ref:s,"onUpdate:modelValue":t[0]||(t[0]=f=>r.value=f),type:"text",class:"search-input",placeholder:"搜索文章...",onKeyup:[C(p,["enter"]),C(c,["esc"])]},null,544),[[M,r.value]]),r.value?(h(),d("button",{key:0,class:"clear-button",onClick:c,"aria-label":"清除搜索"},[...t[1]||(t[1]=[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])):m("",!0),a("button",{class:"search-button",onClick:p,"aria-label":"搜索"},[...t[2]||(t[2]=[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("circle",{cx:"11",cy:"11",r:"8"}),a("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1)])])]),t[3]||(t[3]=a("div",{class:"search-hint"},[y(" 按 "),a("kbd",null,"Ctrl"),y(" + "),a("kbd",null,"K"),y(" 快速搜索 ")],-1))]))}}),P=S(O,[["__scopeId","data-v-51358d19"]]);function j(l,u){if(!u.trim())return[];const e=u.toLowerCase().split(/\s+/).filter(r=>r.length>0),n=[];for(const r of l){const s=U(r,e);if(s>0){const p=z(r,e);n.push({...r,score:s,matchedFields:p})}}return n.sort((r,s)=>s.score-r.score)}function U(l,u){var n,r;let e=0;for(const s of u){const p=l.title.toLowerCase(),c=l.excerpt.toLowerCase(),i=((n=l.tags)==null?void 0:n.map(t=>t.toLowerCase()))||[],o=((r=l.category)==null?void 0:r.toLowerCase())||"";p.includes(s)&&(e+=10,p.startsWith(s)&&(e+=5)),c.includes(s)&&(e+=3);for(const t of i)t.includes(s)&&(e+=7,t===s&&(e+=3));o.includes(s)&&(e+=7,o===s&&(e+=3))}return e}function z(l,u){var n,r;const e=[];for(const s of u){const p=l.title.toLowerCase(),c=l.excerpt.toLowerCase(),i=((n=l.tags)==null?void 0:n.map(t=>t.toLowerCase()))||[],o=((r=l.category)==null?void 0:r.toLowerCase())||"";p.includes(s)&&(e.includes("title")||e.push("title")),c.includes(s)&&(e.includes("content")||e.push("content"));for(const t of i)if(t.includes(s)){e.includes("tags")||e.push("tags");break}o.includes(s)&&(e.includes("category")||e.push("category"))}return e}function T(l,u){if(!u.trim())return l;const e=u.toLowerCase().split(/\s+/).filter(r=>r.length>0);let n=l;for(const r of e){const s=new RegExp(`(${W(r)})`,"gi");n=n.replace(s,"<mark>$1</mark>")}return n}function W(l){return l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const G={class:"search-page"},J={class:"search-header"},Q={key:0,class:"search-results"},X={class:"search-info"},Y={class:"search-count"},Z={class:"search-query"},ee={key:0,class:"results-list"},te=["innerHTML"],se={class:"result-meta"},oe={class:"result-date"},re={key:0,class:"result-category"},ae={key:1,class:"matched-fields"},ne=["innerHTML"],ce={key:0,class:"result-tags"},le={key:1,class:"no-results"},ie={key:1,class:"search-placeholder"},ue=E({__name:"Search",setup(l){const u=$(),e=v(""),n=v([]),r=c=>{e.value=c,s()},s=async()=>{if(!e.value.trim()){n.value=[];return}const c=Object.assign({"../../articles/can-matrix-multiplication-be-made-faster1.md":()=>x(()=>import("./can-matrix-multiplication-be-made-faster1-BryDvj1A.js"),[]).then(o=>o.default),"../../articles/vite-vue3-typescripts.md":()=>x(()=>import("./vite-vue3-typescripts-WEZjlbqQ.js"),[]).then(o=>o.default),"../../articles/welcome.md":()=>x(()=>import("./welcome-CSV5dFql.js"),[]).then(o=>o.default)}),i=[];for(const o in c){const t=c[o],f=await t(),q=o.replace("../../articles/","").replace(".md",""),_=B(f,q);i.push({slug:_.slug,title:_.title,date:_.date,tags:_.tags,category:_.category,excerpt:_.excerpt||"",readingTime:_.readingTime})}n.value=j(i,e.value)},p=c=>({title:"标题",content:"内容",tags:"标签",category:"分类"})[c]||c;return V(()=>u.query.q,c=>{c&&typeof c=="string"&&(e.value=c,s())},{immediate:!0}),R(()=>{u.query.q&&typeof u.query.q=="string"&&(e.value=u.query.q,s())}),(c,i)=>{const o=D("RouterLink");return h(),d("div",G,[a("div",J,[i[0]||(i[0]=a("h1",{class:"search-title"},"搜索",-1)),b(P,{ref:"searchInputRef",onSearch:r},null,512)]),e.value?(h(),d("div",Q,[a("div",X,[a("span",Y,g(n.value.length)+" 篇文章",1),a("span",Z,'包含 "'+g(e.value)+'"',1)]),n.value.length>0?(h(),d("div",ee,[(h(!0),d(k,null,w(n.value,t=>(h(),d("div",{key:t.slug,class:"result-item"},[b(o,{to:`/article/${t.slug}`,class:"result-link"},{default:A(()=>[a("h2",{class:"result-title",innerHTML:L(T)(t.title,e.value)},null,8,te),a("div",se,[a("span",oe,g(L(K)(t.date)),1),t.category?(h(),d("span",re,g(t.category),1)):m("",!0),t.matchedFields?(h(),d("div",ae,[(h(!0),d(k,null,w(t.matchedFields,f=>(h(),d("span",{key:f,class:"matched-field"},g(p(f)),1))),128))])):m("",!0)]),a("p",{class:"result-excerpt",innerHTML:L(T)(t.excerpt,e.value)},null,8,ne),t.tags&&t.tags.length>0?(h(),d("div",ce,[(h(!0),d(k,null,w(t.tags,f=>(h(),d("span",{key:f,class:"tag"},g(f),1))),128))])):m("",!0)]),_:2},1032,["to"])]))),128))])):(h(),d("div",le,[...i[1]||(i[1]=[a("p",null,"没有找到匹配的文章",-1),a("p",{class:"no-results-hint"},"尝试使用不同的关键词搜索",-1)])]))])):(h(),d("div",ie,[...i[2]||(i[2]=[a("p",null,"输入关键词开始搜索文章",-1)])]))])}}}),pe=S(ue,[["__scopeId","data-v-680b2894"]]);export{pe as default};
