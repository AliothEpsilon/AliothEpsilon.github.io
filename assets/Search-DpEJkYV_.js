import{d as S,r as m,k as R,s as F,a as d,o as h,b as a,w as M,j as y,z as $,A as L,f as v,_ as E,q as I,u as V,g as C,t as _,F as k,e as w,l as b,y as D,h as B,i as x}from"./index-Bce5yI6g.js";import{p as K,f as A}from"./article-DfwNoQky.js";const H={class:"search-input-container"},N={class:"search-input-wrapper"},O=S({__name:"SearchInput",emits:["search"],setup(l,{expose:u,emit:e}){const n=e,o=m(""),s=m(),p=()=>{o.value.trim()&&n("search",o.value)},c=()=>{var r;o.value="",(r=s.value)==null||r.focus()},i=r=>{var t;(r.ctrlKey||r.metaKey)&&r.key==="k"&&(r.preventDefault(),(t=s.value)==null||t.focus())};return R(()=>{document.addEventListener("keydown",i)}),F(()=>{document.removeEventListener("keydown",i)}),u({focus:()=>{var r;return(r=s.value)==null?void 0:r.focus()}}),(r,t)=>(h(),d("div",H,[a("div",N,[M(a("input",{ref_key:"inputRef",ref:s,"onUpdate:modelValue":t[0]||(t[0]=f=>o.value=f),type:"text",class:"search-input",placeholder:"搜索文章...",onKeyup:[L(p,["enter"]),L(c,["esc"])]},null,544),[[$,o.value]]),o.value?(h(),d("button",{key:0,class:"clear-button",onClick:c,"aria-label":"清除搜索"},[...t[1]||(t[1]=[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])):y("",!0),a("button",{class:"search-button",onClick:p,"aria-label":"搜索"},[...t[2]||(t[2]=[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("circle",{cx:"11",cy:"11",r:"8"}),a("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1)])])]),t[3]||(t[3]=a("div",{class:"search-hint"},[v(" 按 "),a("kbd",null,"Ctrl"),v(" + "),a("kbd",null,"K"),v(" 快速搜索 ")],-1))]))}}),P=E(O,[["__scopeId","data-v-51358d19"]]);function j(l,u){if(!u.trim())return[];const e=u.toLowerCase().split(/\s+/).filter(o=>o.length>0),n=[];for(const o of l){const s=U(o,e);if(s>0){const p=z(o,e);n.push({...o,score:s,matchedFields:p})}}return n.sort((o,s)=>s.score-o.score)}function U(l,u){var n,o;let e=0;for(const s of u){const p=l.title.toLowerCase(),c=l.excerpt.toLowerCase(),i=((n=l.tags)==null?void 0:n.map(t=>t.toLowerCase()))||[],r=((o=l.category)==null?void 0:o.toLowerCase())||"";p.includes(s)&&(e+=10,p.startsWith(s)&&(e+=5)),c.includes(s)&&(e+=3);for(const t of i)t.includes(s)&&(e+=7,t===s&&(e+=3));r.includes(s)&&(e+=7,r===s&&(e+=3))}return e}function z(l,u){var n,o;const e=[];for(const s of u){const p=l.title.toLowerCase(),c=l.excerpt.toLowerCase(),i=((n=l.tags)==null?void 0:n.map(t=>t.toLowerCase()))||[],r=((o=l.category)==null?void 0:o.toLowerCase())||"";p.includes(s)&&(e.includes("title")||e.push("title")),c.includes(s)&&(e.includes("content")||e.push("content"));for(const t of i)if(t.includes(s)){e.includes("tags")||e.push("tags");break}r.includes(s)&&(e.includes("category")||e.push("category"))}return e}function T(l,u){if(!u.trim())return l;const e=u.toLowerCase().split(/\s+/).filter(o=>o.length>0);let n=l;for(const o of e){const s=new RegExp(`(${W(o)})`,"gi");n=n.replace(s,"<mark>$1</mark>")}return n}function W(l){return l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const G={class:"search-page"},J={class:"search-header"},Q={key:0,class:"search-results"},X={class:"search-info"},Y={class:"search-count"},Z={class:"search-query"},ee={key:0,class:"results-list"},te=["innerHTML"],se={class:"result-meta"},oe={class:"result-date"},re={key:0,class:"result-category"},ae={key:1,class:"matched-fields"},ne=["innerHTML"],ce={key:0,class:"result-tags"},le={key:1,class:"no-results"},ie={key:1,class:"search-placeholder"},ue=S({__name:"Search",setup(l){const u=V(),e=m(""),n=m([]),o=c=>{e.value=c,s()},s=async()=>{if(!e.value.trim()){n.value=[];return}const c=Object.assign({"../../articles/vite-vue3-typescripts.md":()=>b(()=>import("./vite-vue3-typescripts-r9Twfv4g.js"),[]).then(r=>r.default),"../../articles/welcome.md":()=>b(()=>import("./welcome-CSV5dFql.js"),[]).then(r=>r.default)}),i=[];for(const r in c){const t=c[r],f=await t(),q=r.replace("../../articles/","").replace(".md",""),g=K(f,q);i.push({slug:g.slug,title:g.title,date:g.date,tags:g.tags,category:g.category,excerpt:g.excerpt||"",readingTime:g.readingTime})}n.value=j(i,e.value)},p=c=>({title:"标题",content:"内容",tags:"标签",category:"分类"})[c]||c;return I(()=>u.query.q,c=>{c&&typeof c=="string"&&(e.value=c,s())},{immediate:!0}),R(()=>{u.query.q&&typeof u.query.q=="string"&&(e.value=u.query.q,s())}),(c,i)=>{const r=D("RouterLink");return h(),d("div",G,[a("div",J,[i[0]||(i[0]=a("h1",{class:"search-title"},"搜索",-1)),C(P,{ref:"searchInputRef",onSearch:o},null,512)]),e.value?(h(),d("div",Q,[a("div",X,[a("span",Y,_(n.value.length)+" 篇文章",1),a("span",Z,'包含 "'+_(e.value)+'"',1)]),n.value.length>0?(h(),d("div",ee,[(h(!0),d(k,null,w(n.value,t=>(h(),d("div",{key:t.slug,class:"result-item"},[C(r,{to:`/article/${t.slug}`,class:"result-link"},{default:B(()=>[a("h2",{class:"result-title",innerHTML:x(T)(t.title,e.value)},null,8,te),a("div",se,[a("span",oe,_(x(A)(t.date)),1),t.category?(h(),d("span",re,_(t.category),1)):y("",!0),t.matchedFields?(h(),d("div",ae,[(h(!0),d(k,null,w(t.matchedFields,f=>(h(),d("span",{key:f,class:"matched-field"},_(p(f)),1))),128))])):y("",!0)]),a("p",{class:"result-excerpt",innerHTML:x(T)(t.excerpt,e.value)},null,8,ne),t.tags&&t.tags.length>0?(h(),d("div",ce,[(h(!0),d(k,null,w(t.tags,f=>(h(),d("span",{key:f,class:"tag"},_(f),1))),128))])):y("",!0)]),_:2},1032,["to"])]))),128))])):(h(),d("div",le,[...i[1]||(i[1]=[a("p",null,"没有找到匹配的文章",-1),a("p",{class:"no-results-hint"},"尝试使用不同的关键词搜索",-1)])]))])):(h(),d("div",ie,[...i[2]||(i[2]=[a("p",null,"输入关键词开始搜索文章",-1)])]))])}}}),pe=E(ue,[["__scopeId","data-v-680b2894"]]);export{pe as default};
